<div class="page">
  <div class="button-block">
    <button nz-button nzType="primary" [routerLink]="['/projects/new']">
      {{ 'projects.actions.new_project' | translate }}
    </button>
  </div>
  <nz-table #filterTable [nzData]="projectList" nzTableLayout="fixed" *ngIf="projectList$ | async as projectList">
    <thead>
      <tr>
        <th
          *ngFor="let column of listOfColumns"
          nzCustomFilter
          [nzSortOrder]="column.sortOrder"
          [nzSortFn]="column.sortFn"
          [nzSortDirections]="column.sortDirections"
        >
          {{ column.name | translate }}

          <nz-filter-trigger
            *ngIf="column.searchType === 'text'"
            [nzActive]="searchData.length > 0"
            [nzDropdownMenu]="menu"
          >
            <span nz-icon nzType="search" (click)="onFilterTrigger(column.searchField)"></span>
          </nz-filter-trigger>

          <nz-filter-trigger
            *ngIf="column.searchType === 'date'"
            [nzActive]="searchData.length > 0"
            [nzDropdownMenu]="datemenu"
          >
            <span nz-icon nzType="search" (click)="onFilterTrigger(column.searchField)"></span>
          </nz-filter-trigger>
        </th>
      </tr>
    </thead>
    <tbody>
      <tr
        *ngFor="let data of filterTable.data | tableFilter: searchData:searchField"
        [routerLink]="['/projects/', data.id]"
      >
        <td>{{ data.attributes.name }}</td>
        <td>{{ data.attributes.from }}</td>
        <td>
          <div class="td-wrapper">
            {{ data.attributes.to }}
            <i
              nz-icon
              nzType="delete"
              nzTheme="outline"
              class="td-wrapper__nz-icon"
              nz-popconfirm
              [nzPopconfirmTitle]="'popconfirm.title' | translate"
              [nzOkText]="'popconfirm.ok' | translate"
              [nzCancelText]="'popconfirm.cancel' | translate"
              nzPopconfirmPlacement="left"
              (nzOnConfirm)="deleteItem(data.id)"
              (click)="onClick($event)"
            ></i>
          </div>
        </td>
      </tr>
    </tbody>
  </nz-table>

  <nz-dropdown-menu #menu="nzDropdownMenu">
    <div class="ant-table-filter-dropdown">
      <div class="search-box">
        <input
          type="text"
          nz-input
          [placeholder]="'table_filter.placeholder' | translate"
          [formControl]="searchControl"
        />
      </div>
    </div>
  </nz-dropdown-menu>

  <nz-dropdown-menu #datemenu="nzDropdownMenu">
    <nz-range-picker [formControl]="searchDateContorl"></nz-range-picker>
  </nz-dropdown-menu>
</div>
